<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>Security Training</title>

<style>
body {
  margin: 0;
  font-family: Consolas, monospace;
}

.screen {
  display: none;
  position: relative;
  width: 100vw;
  height: 100vh;
  padding: 40px;
  box-sizing: border-box;
}

/* ---------- screen 1 ---------- */
#screen1 {
  display: block;
  background: #000;
  color: #fff;
  text-align: center;
  cursor: pointer;
}

#countdown {
  font-size: 56px;
  margin-bottom: 20px;
}

.info {
  margin-top: 24px;
  line-height: 1.8;
  opacity: .8;
}

/* ---------- screen 2 ---------- */
#screen2 {
  background: #000;
  color: #00ff66;
  display: flex;
  justify-content: center;
  align-items: center;
}

#logBox {
  width: 85%;
  height: 85%;
  border: 2px solid #00ff66;
  padding: 20px;
  background: rgba(0,255,102,0.05);
  overflow-y: auto;
}

.fixed {
  position: sticky;
  top: 0;
  background: #000;
  font-weight: bold;
}

.log {
  font-size: 14px;
  line-height: 1.6;
}

/* ---------- screen 3 ---------- */
#screen3 {
  background: #b00000;
  font-family: "Segoe UI", sans-serif;
}

.box {
  width: 520px;
  margin: 80px auto;
  background: #fff;
  color: #000;
  padding: 24px;
}

/* ---------- screen 4 ---------- */
#training {
  background: #f4f6f8;
  font-family: "Segoe UI", sans-serif;
}

/* ---------- warning ---------- */
#warningOverlay {
  display: none;
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.85);
  z-index: 9999;
}

#warningBox {
  max-width: 520px;
  margin: 15% auto;
  background: #b00000;
  color: #fff;
  padding: 24px;
}

button {
  margin-top: 20px;
  padding: 8px 16px;
}
</style>
</head>

<body>

<!-- screen 1 -->
<div class="screen" id="screen1" onclick="forceFullscreen()">
  <div id="countdown"></div>
  <div>
    申込受付<br><br>
    下記内容で登録致します。<br>
    ご登録ありがとうございました。
  </div>
  <div class="info" id="pcInfo1"></div>
</div>

<!-- screen 2 -->
<div class="screen" id="screen2">
  <div id="logBox">
    <div class="fixed">SYSTEM INITIALIZING...</div>
    <div id="logs"></div>
  </div>
</div>

<!-- screen 3 -->
<div class="screen" id="screen3">
  <div class="box">
    <h2>✓ 登録完了</h2>
    <p>受付日時：<span id="time"></span></p>
    <div class="info" id="pcInfo3"></div>
  </div>
</div>

<!-- screen 4 -->
<div class="screen" id="training">
  <div class="box">
    <h2>これはセキュリティ訓練です</h2>
    <p>
      この画面は訓練用サイトです。<br>
      実際の申込や送信は行われていません。<br>
      怪しいメールの場合はリンクにカーソルを<br>
      合わせるとリンク先のアドレスが表示されます。<br>
      そのアドレスを見ることも心掛けてください。
    </p>
    <button onclick="showWarning()">閉じる</button>
  </div>
</div>

<!-- warning -->
<div id="warningOverlay">
  <div id="warningBox">
    <h2>⚠ セキュリティ警告</h2>
    <p>
      そうやって安易にボタンを押すと、<br>
      実際にはウイルス感染や<br>
      情報漏えいにつながります。<br><br>
      総合管理部　内山
    </p>
    <button onclick="closeWarning()">理解しました</button>
  </div>
</div>

<script>
/* ---------- fullscreen ---------- */
function forceFullscreen() {
  if (!document.fullscreenElement) {
    document.documentElement.requestFullscreen().catch(()=>{});
  }
}

/* ---------- PC info ---------- */
function rand(min,max){
  return Math.floor(Math.random()*(max-min+1))+min;
}

const pcInfoText =
  `PC名：OFFICE-PC${rand(10,99)}<br>` +
  `OS：${navigator.platform}<br>` +
  `ブラウザ：${navigator.userAgent.split(" ")[0]}<br>` +
  `IP：203.0.113.${rand(10,240)}`;

pcInfo1.innerHTML = pcInfoText;
pcInfo3.innerHTML = pcInfoText;

/* ---------- countdown（3→2→1 / 2秒） ---------- */
async function startCountdown() {
  const STEP_TIME = 222; // ms

  for (let num = 3; num >= 1; num--) {
    for (let dots = 0; dots <= 2; dots++) {
      countdown.textContent = num + ".".repeat(dots);
      await new Promise(r => setTimeout(r, STEP_TIME));
    }
  }
  startLogs();
}
startCountdown();

/* ---------- logs（行数多・3秒固定） ---------- */
const logTexts = [
  "Connecting to remote host...",
  "Resolving DNS records...",
  "Establishing secure channel...",
  "Negotiating TLS parameters...",
  "Authentication token accepted",
  "Validating session integrity",
  "Enumerating system resources",
  "Collecting hardware profile",
  "Uploading session fingerprint",
  "Scanning open ports",
  "Analyzing network topology",
  "Extracting browser metadata",
  "Encrypting outbound stream",
  "Compressing payload blocks",
  "Uploading data blocks",
  "Verifying checksum",
  "Synchronizing remote buffers",
  "Writing transaction logs",
  "Finalizing transaction",
  "Registering completion flag",
  "Disconnecting from host",
  "Terminating secure tunnel",
  "Clearing traces",
  "Flushing memory buffers",
  "Revoking temporary tokens",
  "Resetting network adapter",
  "Closing background services",
  "Process completed successfully"
];

const TOTAL_LOG_TIME = 3000;
const totalChars = logTexts.reduce((s,t)=>s+t.length,0);
const CHAR_SPEED = Math.max(4, Math.floor(TOTAL_LOG_TIME / totalChars));

async function typeLine(text) {
  return new Promise(resolve => {
    const line = document.createElement("div");
    line.className = "log";
    logs.appendChild(line);

    const prefix = `[${new Date().toLocaleTimeString()}] `;
    let i = 0;

    const timer = setInterval(() => {
      line.textContent = prefix + text.slice(0, ++i);
      logBox.scrollTop = logBox.scrollHeight;
      if (i >= text.length) {
        clearInterval(timer);
        resolve();
      }
    }, CHAR_SPEED);
  });
}

async function startLogs() {
  screen1.style.display = "none";
  screen2.style.display = "flex";
  for (const t of logTexts) await typeLine(t);
  showResult();
}

/* ---------- result ---------- */
function showResult() {
  screen2.style.display = "none";
  screen3.style.display = "block";
  time.textContent = new Date().toLocaleString();

  setTimeout(() => {
    screen3.style.display = "none";
    training.style.display = "block";
  }, 2000);
}

/* ---------- warning ---------- */
function showWarning() {
  if (document.fullscreenElement) document.exitFullscreen();
  warningOverlay.style.display = "block";
}
function closeWarning() {
  warningOverlay.style.display = "none";
}
</script>

</body>
</html>
